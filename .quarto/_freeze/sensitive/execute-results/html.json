{
  "hash": "e7087176a427bd25a9ac21f581db3a88",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analisi di sensibilità\"\nauthor: \"Lorenzo Atzeni\"\neditor: visual\nformat:\n  html:\n    self-contained: true\n    number-sections: false\n---\n\n\n\n\n## Sensitivity Analysis\n\nIn questa pagina sono presenti le **analisi di sensitività/robustezza** per verificare se le conclusioni del modello principale (m_level0=\\> tPTEF%tE \\~ BPD × hsPDA ) **cambiano** quando modifichiamo la definizione delle esposizioni. In particolare: (i) sostituiamo BPD binaria con **BPD per severità** (no/mild/moderate/severe), e (ii) ricodifichiamo hsPDA da continuo a **categorie cliniche** (0, 1–7, \\>7) o a una forma **piecewise** (effetto 0–7 distinto dall’effetto oltre 7), così da testare l’ipotesi di una “critical window” e confrontare i modelli anche tramite **AIC**.\n\n## 1) **BPD per severità** (no/mild/moderate/severe)\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nVediamo come si distribuiscono i punteggi della severità di BPD:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](sensitive_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nLa categoria mild è scarsamente rappresentata (n=1), pertanto le stime specifiche per mild (in particolare le interazioni con hsPDA) non sono interpretabili; il modello viene usato solo come analisi esplorativa/sensitività. Si può fittare il modello ma ci saranno celle vuote/scarsamente popolate nelle combinazioni BPD_sev × hsPDA e ovviamente alcune interazioni non saranno stimabili (termini rimossi per rank-deficiency). Pertanto, il modello non consente inferenze affidabili specifiche per il livello mild.\n\nAlternative migliori per un'eventuale pubblicazione potrebbero essere il collassare quindi unire mild + moderate e fare un modello solo con moderate+severe vs noBPD.\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: Gamma  ( log )\nFormula:          \ntPTEF_perc_tE ~ Time + BPD_sev * hsPDA + GA + sex + LOS + PH +      (1 | ID)\nData: df_sens\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n     1246      1292      -609      1218       183 \n\nRandom effects:\n\nConditional model:\n Groups Name        Variance Std.Dev.\n ID     (Intercept) 0.04449  0.2109  \nNumber of obs: 197, groups:  ID, 84\n\nDispersion estimate for Gamma family (sigma^2): 0.0578 \n\nConditional model:\n                       Estimate Std. Error z value Pr(>|z|)   \n(Intercept)            1.609844   0.547621   2.940  0.00329 **\nTime                  -0.003128   0.003259  -0.960  0.33724   \nBPD_sevmild           -0.067622   0.342228  -0.198  0.84336   \nBPD_sevmoderate       -0.105006   0.087039  -1.206  0.22765   \nBPD_sevsevere         -0.077540   0.289144  -0.268  0.78857   \nhsPDA                 -0.006546   0.014738  -0.444  0.65694   \nGA                     0.050657   0.018667   2.714  0.00665 **\nsex2                   0.150369   0.067717   2.221  0.02638 * \nLOS1                   0.050767   0.070474   0.720  0.47130   \nPH1                   -0.203994   0.079054  -2.580  0.00987 **\nBPD_sevmild:hsPDA            NA         NA      NA       NA   \nBPD_sevmoderate:hsPDA  0.006666   0.016384   0.407  0.68409   \nBPD_sevsevere:hsPDA   -0.220178   0.201861  -1.091  0.27539   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n## 2) Categorico PDA: 0 / 1–7 / \\>7\n\nVediamo anche qui la frequenza:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](sensitive_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_pda_cat <- df_mod %>%\n  mutate(\n    hsPDA_cat = cut(hsPDA, breaks = c(-Inf, 0, 7, Inf),\n                    labels = c(\"0\", \"1-7\", \">7\")),\n    hsPDA_cat = relevel(hsPDA_cat, ref = \"0\")\n  )\n\nm_pda_cat <- glmmTMB(\n  tPTEF_perc_tE ~ Time + BPD * hsPDA_cat + GA + sex + LOS + PH + (1 | ID),\n  family = Gamma(link = \"log\"),\n  data = df_pda_cat\n)\nsummary(m_pda_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: Gamma  ( log )\nFormula:          \ntPTEF_perc_tE ~ Time + BPD * hsPDA_cat + GA + sex + LOS + PH +      (1 | ID)\nData: df_pda_cat\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   1245.4    1288.0    -609.7    1219.4       184 \n\nRandom effects:\n\nConditional model:\n Groups Name        Variance Std.Dev.\n ID     (Intercept) 0.04542  0.2131  \nNumber of obs: 197, groups:  ID, 84\n\nDispersion estimate for Gamma family (sigma^2): 0.0579 \n\nConditional model:\n                   Estimate Std. Error z value Pr(>|z|)   \n(Intercept)        1.777310   0.573318   3.100  0.00193 **\nTime              -0.003191   0.003241  -0.985  0.32484   \nBPD1              -0.131903   0.107231  -1.230  0.21867   \nhsPDA_cat1-7       0.014504   0.112318   0.129  0.89725   \nhsPDA_cat>7       -0.165148   0.192233  -0.859  0.39028   \nGA                 0.044899   0.019444   2.309  0.02094 * \nsex2               0.157384   0.068327   2.303  0.02126 * \nLOS1               0.024619   0.070892   0.347  0.72838   \nPH1               -0.214522   0.080705  -2.658  0.00786 **\nBPD1:hsPDA_cat1-7  0.035613   0.145217   0.245  0.80627   \nBPD1:hsPDA_cat>7   0.139487   0.220515   0.633  0.52703   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n## 3) Piecewise (0–7 e \\>7)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_piece <- df_mod %>%\n  mutate(\n    pda_0_7 = pmin(hsPDA, 7),\n    pda_gt7 = pmax(hsPDA - 7, 0)\n  )\n\nm_piece <- glmmTMB(\n  tPTEF_perc_tE ~ Time + BPD * (pda_0_7 + pda_gt7) + GA + sex + LOS + PH + (1 | ID),\n  family = Gamma(link = \"log\"),\n  data = df_piece\n)\n\nsummary(m_piece)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: Gamma  ( log )\nFormula:          \ntPTEF_perc_tE ~ Time + BPD * (pda_0_7 + pda_gt7) + GA + sex +  \n    LOS + PH + (1 | ID)\nData: df_piece\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   1241.3    1283.9    -607.6    1215.3       184 \n\nRandom effects:\n\nConditional model:\n Groups Name        Variance Std.Dev.\n ID     (Intercept) 0.04174  0.2043  \nNumber of obs: 197, groups:  ID, 84\n\nDispersion estimate for Gamma family (sigma^2): 0.058 \n\nConditional model:\n              Estimate Std. Error z value Pr(>|z|)   \n(Intercept)   1.579002   0.530639   2.976  0.00292 **\nTime         -0.003019   0.003229  -0.935  0.34971   \nBPD1         -0.149657   0.089623  -1.670  0.09495 . \npda_0_7       0.019791   0.027913   0.709  0.47830   \npda_gt7      -0.053900   0.047053  -1.146  0.25200   \nGA            0.052430   0.018106   2.896  0.00378 **\nsex2          0.146794   0.066688   2.201  0.02772 * \nLOS1         -0.017905   0.071104  -0.252  0.80119   \nPH1          -0.211027   0.076228  -2.768  0.00563 **\nBPD1:pda_0_7  0.011911   0.031040   0.384  0.70118   \nBPD1:pda_gt7  0.029589   0.049101   0.603  0.54676   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nConfrontiamo i modelli:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_level0 <- readRDS(here(\"data\", \"derived\", \"m_level0.rds\"))\nAIC(m_level0, m_sev, m_pda_cat, m_piece)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          df      AIC\nm_level0  11 1242.492\nm_sev     14 1246.020\nm_pda_cat 13 1245.354\nm_piece   13 1241.264\n```\n\n\n:::\n\n```{.r .cell-code}\nBIC(m_level0, m_sev, m_pda_cat, m_piece)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          df      BIC\nm_level0  11 1278.607\nm_sev     14 1291.985\nm_pda_cat 13 1288.036\nm_piece   13 1283.946\n```\n\n\n:::\n:::\n\n\n\n\nNel complesso, le analisi di sensitività **non modificano in modo sostanziale le conclusioni** del modello principale.\n\n<a href=\"outcome_secondari.html\" class=\"btn btn-primary\">← Torna indietro</a>\n",
    "supporting": [
      "sensitive_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}